/* -*- coding: utf-8 -*-
 * ----------------------------------------------------------------------
 * Copyright Â© 2012, RedJack, LLC.
 * All rights reserved.
 *
 * Please see the LICENSE.txt file in this distribution for license
 * details.
 * ----------------------------------------------------------------------
 */

#include <assert.h>

#include "swanson/kernel.h"
#include "swanson/metamodel.h"


_static_op_(swan_static, alias)
{
    assert(param_count == 2);
    assert(swan_value_is_empty(&params[1]));
    params[1] = params[0];
    return 0;
}

_static_op_(swan_static, unref)
{
    assert(param_count == 1);
    swan_value_clear(&params[0]);
    return 0;
}

_public_simple_opset_(swan_static)
{
    get_static_op("~alias", swan_static, alias);
    get_static_op("~unref", swan_static, unref);
    return NULL;
}


/*-----------------------------------------------------------------------
 * Helper macros
 */

#define _declare_static_opset_  _declare_simple_opset_

#define _static_opset_(name, base_name) \
_simple_opset_(name) \
{ \
    try_get_operation(base_name); \
    try_get_operation(swan_static); \
    return NULL; \
}

#define static_opset  simple_opset

#define _public_static_opset_(name, base_name) \
_static_opset_(name, base_name) \
_opset_accessor_(name, static_opset(name));
